<html>
  <head>
    <meta charset="utf-8">
    <title>Browser Benchmarks</title>
    <script src="suite1.js"></script>
    <script src="main.js"></script>
    <script src="lodash.js"></script>
    <script src="platform.js"></script>
    <script src="benchmark.js"></script>

  </head>
  <body>
    <h3 id = "0">Test Suite</h3>
    <script>

      const h1 = document.getElementById("0");

      const b1 = new Benchmark({
        name: 'salsa20_enc with 100 bytes',
        setup: function() {const key = randomKey(); const nonce = randomNonce(); const text = randomText(100);},
        onComplete: function() {
          let p = document.createElement("p");
          let t = document.createTextNode(this.toString());
          p.appendChild(t);
          h1.appendChild(p);
        },
        fn: 'fn1(key, nonce, text)'
      });
      //b1.run();

      const b2 = new Benchmark({
        name: 'salsa20_enc with 1.000 bytes',
        setup: function() {const key = randomKey(); const nonce = randomNonce(); const text = randomText(1000);},
        onComplete: function() {
          let p = document.createElement("p");
          let t = document.createTextNode(this.toString());
          p.appendChild(t);
          h1.appendChild(p);
        },
        fn: 'fn1(key, nonce, text)'
      });
      //b2.run();

      const b3 = new Benchmark({
        name: 'salsa20_enc with 10.000 bytes',
        setup: function() {const key = randomKey(); const nonce = randomNonce(); const text = randomText(10000);},
        onComplete: function() {
          let p = document.createElement("p");
          let t = document.createTextNode(this.toString());
          p.appendChild(t);
          h1.appendChild(p);
        },
        fn: 'fn1(key, nonce, text)'
      });
      //b3.run();

      const b4 = new Benchmark({
        name: 'salsa20_enc with 100.000 bytes',
        setup: function() {const key = randomKey(); const nonce = randomNonce(); const text = randomText(100000);},
        onComplete: function() {
          let p = document.createElement("p");
          let t = document.createTextNode(this.toString());
          p.appendChild(t);
          h1.appendChild(p);
        },
        fn: 'fn1(key, nonce, text)'
      });
      //b4.run();

      const b5 = new Benchmark({
        name: 'salsa20_enc with 1.000.000 bytes',
        setup: function() {const key = randomKey(); const nonce = randomNonce(); const text = randomText(1000000);},
        onComplete: function() {
          let p = document.createElement("p");
          let t = document.createTextNode(this.toString());
          p.appendChild(t);
          h1.appendChild(p);
        },
        fn: 'fn1(key, nonce, text)'
      });
      //b5.run();

      const test_text = window.crypto.getRandomValues(new Uint8Array(65535));

      const webcrypto1 = new Benchmark({
        name: 'webcrypto 1',
        defer: true,
        options: {initCount: 10, delay: 10},
        fn: function(deferred) {
          const prom = window.crypto.subtle.generateKey({
            name: "AES-GCM",
            length:256
          }, false, ["encrypt","decrypt"]);
          prom.then(function(key) {
            window.crypto.subtle.encrypt({
              name: "AES-GCM",
              iv: window.crypto.getRandomValues(new Uint8Array(16))
            }, key, test_text);
          });
          deferred.resolve();
        },
        onComplete: function() {
          let p = document.createElement("p");
          let t = document.createTextNode(this.toString());
          p.appendChild(t);
          h1.appendChild(p);
        }
      });
      //webcrypto1.run();

    </script>
  </body>
</html>

<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>GF256 Tests</title>
  <link rel="stylesheet" href="https://code.jquery.com/qunit/qunit-2.0.1.css">
</head>

<body>
  <div id="qunit"></div>
  <div id="qunit-fixture"></div>
  <script src="https://code.jquery.com/qunit/qunit-2.0.1.js"></script>
  <script src="../src/table.js"></script>
  <script src="../src/gf256.js"></script>
  <script>
    QUnit.test("does alogtable exist?", function(assert) {assert.ok(gf256.alogtable !== undefined)});
    QUnit.test("does logtable exist?", function(assert) {assert.ok(gf256.logtable !== undefined)});
    // direct translation of:
    // https://github.com/Archistar/archistar-smc/blob/master/src/test/java/at/archistar/crypto/math/TestGF256Algebra.java
    QUnit.test("does (a / b) * b = a hold?", function(assert) {
      'use strict';
      for (var a = 0; a <= 255; a++) {
        // limit range of b because issues
        for (var b = 1; b <= 10; b++) {
          var q = gf256.div(a, b);
          var p = gf256.mult(q, b);
          assert.equal(a, p);
        }
      }
    });
    QUnit.test("does a*(1/a) = 1 hold?", function(assert) {
      'use strict';
      for (var a = 1; a <= 255; a++) {
        assert.equal(gf256.mult(a, gf256.inverse(a)), 1);
      }
    });
    QUnit.test("does pow agree with rolling product?", function(assert) {
      'use strict';
      for (var a = 1; a <= 255; a++) {
        var product = 1;
        // limit range of b because issues
        for (var p = 0; p <= 10; p++) {
          var r = gf256.pow(a, p);
          assert.equal(r, product);
          product = gf256.mult(product, a);
        }
      }
    });
  </script>
</body>
</html>
